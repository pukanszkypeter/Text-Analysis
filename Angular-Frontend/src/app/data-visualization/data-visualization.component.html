<div class="container">

  <!-- TABLES SECTION -->
  <div class="tablesContainer">
    <!-- HEADER -->
    <div class="headers">
      <h2>Source Data</h2>
      <p>In this section, I would like to present the source data, which I will use later for text analysis.
        The data set consists of 4 tables, which can be viewed in more detail below.
        The public data set is also available at the following link:
        <a href="https://www.kaggle.com/thoughtvector/podcastreviews" target="_blank">Podcast Reviews</a>.</p>
    </div>
    <!-- CONTENT -->
    <div class="tablesContent">
      <mat-tab-group>
        <!-- Categories -->
        <mat-tab label="Categories" [disabled]="tablesLoading">

          <div class="tableContainer">
            <mat-spinner *ngIf="tablesLoading"></mat-spinner>
            <table mat-table [dataSource]="categoriesSource" *ngIf="!tablesLoading" class="mat-elevation-z8"
                   style="width: 100%">
              <!-- Podcast ID Column -->
              <ng-container matColumnDef="podcastId">
                <th mat-header-cell *matHeaderCellDef style="width: 50%;"> Podcast ID</th>
                <td mat-cell *matCellDef="let element" style="width: 50%;"> {{element.podcastId}} </td>
              </ng-container>
              <!-- Category Column -->
              <ng-container matColumnDef="category">
                <th mat-header-cell *matHeaderCellDef style="width: 50%;"> Category</th>
                <td mat-cell *matCellDef="let element" style="width: 50%;"> {{element.category}} </td>
              </ng-container>
              <tr mat-header-row *matHeaderRowDef="categoriesColumns"></tr>
              <tr mat-row *matRowDef="let row; columns: categoriesColumns;"></tr>
            </table>
          </div>
          <mat-paginator #categoriesPaginator [disabled]="tablesLoading" [length]="categoriesLength" [pageSize]="10"
                         showFirstLastButtons></mat-paginator>
          <div class="tableDescription">
            <p>The category table shows the <strong>(genre / category)</strong> in which a particular podcast channel
              produces.
              In this case, the podcast channels are marked with an <strong>ID</strong>.
              The table contains much more data <strong>(70.945 rows)</strong>, than what we show,
              but for simplicity, we only queried the different categories to which we assigned the very first ID.</p>
          </div>

        </mat-tab>
        <!-- Podcasts -->
        <mat-tab label="Podcasts" [disabled]="tablesLoading">

          <div class="tableContainer">
            <table mat-table [dataSource]="podcastsSource" class="mat-elevation-z8" style="width: 100%">
              <!-- Title Column -->
              <ng-container matColumnDef="title">
                <th mat-header-cell *matHeaderCellDef style="width: 30%;"> Title</th>
                <td mat-cell *matCellDef="let element" style="width: 30%;"> {{element.title}} </td>
              </ng-container>
              <!-- Slug Column -->
              <ng-container matColumnDef="slug">
                <th mat-header-cell *matHeaderCellDef style="width: 30%;"> Slug</th>
                <td mat-cell *matCellDef="let element" style="width: 30%;"> {{element.slug}} </td>
              </ng-container>
              <!-- Itunes URL Column -->
              <ng-container matColumnDef="itunesUrl">
                <th mat-header-cell *matHeaderCellDef style="width: 10%;"> iTunes URL</th>
                <td mat-cell *matCellDef="let element" style="width: 10%;"><a href="{{element.itunesUrl}}"
                                                                              target="_blank">
                  <mat-icon svgIcon="link"></mat-icon>
                </a></td>
              </ng-container>
              <!-- Itunes ID Column -->
              <ng-container matColumnDef="itunesId">
                <th mat-header-cell *matHeaderCellDef style="width: 10%;"> iTunes ID</th>
                <td mat-cell *matCellDef="let element" style="width: 10%;"> {{element.itunsId}} </td>
              </ng-container>
              <!-- Podcast ID Column -->
              <ng-container matColumnDef="podcastId">
                <th mat-header-cell *matHeaderCellDef style="width: 20%;"> Podcast ID</th>
                <td mat-cell *matCellDef="let element" style="width: 20%;"> {{element.podcastId}} </td>
              </ng-container>
              <tr mat-header-row *matHeaderRowDef="podcastsColumns"></tr>
              <tr mat-row *matRowDef="let row; columns: podcastsColumns;"></tr>
            </table>
          </div>
          <mat-paginator #podcastsPaginator [length]="podcastsLength" [pageSize]="25"
                         showFirstLastButtons></mat-paginator>
          <div class="tableDescription">
            <p>The podcast table shows all the information about a particular podcast channel
              <strong>(Title, Slug, URL, IDs).</strong> You can browse through many podcasts,
              but for performance reasons, we only loaded <strong>the first 100 rows.</strong>
              Later on you will be able to query every podcast channel from the data set, which contains altogether
              <strong>46659</strong> rows.</p>
          </div>

        </mat-tab>
        <!-- Reviews -->
        <mat-tab label="Reviews" [disabled]="tablesLoading">

          <div class="tableContainer">
            <table mat-table [dataSource]="reviewsSource" multiTemplateDataRows class="mat-elevation-z8"
                   style="width: 100%">
              <!-- Podcast ID Column -->
              <ng-container matColumnDef="podcastId">
                <th mat-header-cell *matHeaderCellDef style="width: 25%;"> Podcast ID</th>
                <td mat-cell *matCellDef="let element" style="width: 25%;"> {{element.podcastId}} </td>
              </ng-container>
              <!-- Title Column -->
              <ng-container matColumnDef="title">
                <th mat-header-cell *matHeaderCellDef style="width: 30%;"> Title</th>
                <td mat-cell *matCellDef="let element" style="width: 30%;"> {{element.title}} </td>
              </ng-container>
              <!-- Rating Column -->
              <ng-container matColumnDef="rating">
                <th mat-header-cell *matHeaderCellDef style="width: 20%;"> Rating</th>
                <td mat-cell *matCellDef="let element" style="width: 20%;">
                  <span *ngIf="element.rating == 5" style="color: green"><mat-icon svgIcon="star"></mat-icon><mat-icon
                    svgIcon="star"></mat-icon><mat-icon svgIcon="star"></mat-icon><mat-icon svgIcon="star"></mat-icon><mat-icon
                    svgIcon="star"></mat-icon></span>
                  <span *ngIf="element.rating == 4" style="color: blue"><mat-icon svgIcon="star"></mat-icon><mat-icon
                    svgIcon="star"></mat-icon><mat-icon svgIcon="star"></mat-icon><mat-icon
                    svgIcon="star"></mat-icon></span>
                  <span *ngIf="element.rating == 3" style="color: yellow"><mat-icon svgIcon="star"></mat-icon><mat-icon
                    svgIcon="star"></mat-icon><mat-icon svgIcon="star"></mat-icon></span>
                  <span *ngIf="element.rating == 2" style="color: orange"><mat-icon svgIcon="star"></mat-icon><mat-icon
                    svgIcon="star"></mat-icon></span>
                  <span *ngIf="element.rating == 1" style="color: red"><mat-icon svgIcon="star"></mat-icon></span>
                </td>
              </ng-container>
              <!-- Created At Column -->
              <ng-container matColumnDef="createdAt">
                <th mat-header-cell *matHeaderCellDef style="width: 25%;"> Created At</th>
                <td mat-cell *matCellDef="let element" style="width: 25%;"> {{element.createdAt}} </td>
              </ng-container>
              <!-- Expanded Content Column -->
              <ng-container matColumnDef="content">
                <td mat-cell *matCellDef="let element" [attr.colspan]="reviewsColumns.length">
                  <div class="element-content" [@detailExpand]="element == expandedElement ? 'expanded' : 'collapsed'">
                    <div class="content"> "{{element.content}}"</div>
                  </div>
                </td>
              </ng-container>
              <tr mat-header-row *matHeaderRowDef="reviewsColumns"></tr>
              <tr mat-row *matRowDef="let row; columns: reviewsColumns;" class="element-row"
                  [class.expanded-row]="expandedElement === row"
                  (click)="expandedElement = expandedElement === row ? null : row"></tr>
              <tr mat-row *matRowDef="let row; columns: ['content']" style="height: 0"></tr>
            </table>
          </div>
          <mat-paginator #reviewsPaginator [length]="reviewsLength" [pageSize]="25"
                         showFirstLastButtons></mat-paginator>
          <div class="tableDescription">
            <p>The reviews table contains the most data, with exactly <strong>1.148.214</strong> rows.
              This includes (feedbacks / reviews) from iTunes Podcast users about each podcast channel.
              One row consists the <strong>podcast ID</strong>, the <strong>title and content</strong> of the review,
              the <strong>5-star rating</strong> and the <strong>creation date</strong>.
              For performance reasons we only loaded the first 100 rows of the data set. Have fun reading the reviews
              by clicking on
              each row in the table.</p>
          </div>

        </mat-tab>
        <!-- Runs -->
        <mat-tab label="Runs" [disabled]="tablesLoading">

          <div class="tableContainer">
            <table mat-table [dataSource]="runsSource" class="mat-elevation-z8" style="width: 100%">
              <!-- Run At Column -->
              <ng-container matColumnDef="runAt">
                <th mat-header-cell *matHeaderCellDef style="width: 33.3%;"> Run At</th>
                <td mat-cell *matCellDef="let element" style="width: 33.3%;"> {{element.runAt}} </td>
              </ng-container>
              <!-- Max Rowid Column -->
              <ng-container matColumnDef="maxRowid">
                <th mat-header-cell *matHeaderCellDef style="width: 33.3%;"> Max Rowid</th>
                <td mat-cell *matCellDef="let element" style="width: 33.3%;"> {{element.maxRowid}} </td>
              </ng-container>
              <!-- Reviews Added Column -->
              <ng-container matColumnDef="reviewsAdded">
                <th mat-header-cell *matHeaderCellDef style="width: 33.3%;"> Reviews Added</th>
                <td mat-cell *matCellDef="let element" style="width: 33.3%;"> {{element.reviewsAdded}} </td>
              </ng-container>
              <tr mat-header-row *matHeaderRowDef="runsColumns"></tr>
              <tr mat-row *matRowDef="let row; columns: runsColumns;"></tr>
            </table>
          </div>
          <mat-paginator #runsPaginator [disabled]="tablesLoading" [length]="runsLength" [pageSize]="10"
                         showFirstLastButtons></mat-paginator>
          <div class="tableDescription">
            <p>The runs table shows us at what times the publicly available data set was updated with additional data.
              You can see that the last modification date is January 2021, and I am using that state of the database.
              Newer versions may already exist, but they can be solved with a simple replacement.
              It may be interesting to look at the <strong>reviews added</strong> column and add the rows to get the
              number of reviews in the dataset.</p>
          </div>

        </mat-tab>
      </mat-tab-group>
    </div>
  </div>

  <!-- Podcast Viewer -->
  <div class="podcastViewer">

    <div class="headers">
      <h2>Podcasts</h2>
      <p>Here you can search for a specific Podcast channel and extract various information about it.
        For example, what comments belong to it or what categories it belongs to.
        Go ahead and search for a title with this stepper guide.</p>
    </div>
    <mat-horizontal-stepper linear #stepper>
      <mat-step [stepControl]="firstFormGroup" [editable]="false" label="Search for Title">
        <form [formGroup]="firstFormGroup">
          <mat-form-field appearance="outline">
            <mat-label>Podcast Title</mat-label>
            <input matInput #title formControlName="firstCtrl" placeholder="Search for a title..." required>
          </mat-form-field>
        </form>
        <button [disabled]="!firstFormGroup.valid" mat-icon-button (click)="filter(title)" matStepperNext>
          <mat-icon class="iconWhite" >search</mat-icon>
        </button>
      </mat-step>
      <mat-step [stepControl]="false" [editable]="false" label="Select a Podcast">
        <mat-selection-list #results [multiple]="false">
          <mat-list-option *ngFor="let result of filterResult" [value]="result">
            {{ result }}
          </mat-list-option>
        </mat-selection-list>
        <p>
          Option selected: <span id="title">{{results.selectedOptions.selected[0]?.value}}</span>
        </p>
        <button mat-raised-button [disabled]="!results.selectedOptions.selected[0]?.value" (click)="search()" matStepperNext>Load Data</button>
      </mat-step>
      <mat-step label="Show Data">
        <ul>
          <li>{{ searchResult.podcastId }}</li>
          <li>{{ searchResult.itunsId }}</li>
          <li>{{ searchResult.title }}</li>
          <li>{{ searchResult.slug }}</li>
          <li>{{ searchResult.itunesUrl }}</li>
        </ul>
        <ul *ngFor="let category of searchCategories">
          <li>{{ category }}</li>
        </ul>
        <ul *ngFor="let review of searchReviews">
          <li>{{ review.podcastId }}</li>
        </ul>
        <button mat-button (click)="stepper.reset()">Reset</button>
      </mat-step>
    </mat-horizontal-stepper>
  </div>

  <!-- Word Clouds -->
  <div class="wordCloud">
    <div class="headers" style="width: 90%">
      <h2>Word Clouds</h2>
      <p>Word clouds are an excellent form of visualizing text data.
        They can identify the most used words within a document.
        I used it in this case for sentiment analysis, where I took measurements on a two-dimensional scale, more
        specifically <strong>positive and negative</strong> feelings.
        I did the calculations in a Jupyter Notebook, based on the following link: <a
          href="https://www.kaggle.com/ngyptr/python-nltk-sentiment-analysis" target="_blank">Python NLTK sentiment
          analysis</a>, and then saved the results in the form of an image, which you can see below.</p>
    </div>
    <mat-grid-list cols="2" rowHeight="640px" style="margin-top: -15px">
      <mat-grid-tile>
        <mat-card class="wc-card">
          <mat-card-header>
            <mat-card-title>Positive Words</mat-card-title>
          </mat-card-header>
          <img mat-card-image width="100%" height="475px" src="../../assets/data-visualization/positive_words.png" alt="Positive Words">
          <mat-card-content>
            <p>
              It seems to be the most used keywords: podcast, listen, love, episode, etc ...
              It can be even more interesting to observe better we can also find words like friend, informative, best,
              entertaining, good, fun.
            </p>
          </mat-card-content>
        </mat-card>
      </mat-grid-tile>
      <mat-grid-tile>
        <mat-card class="wc-card">
          <mat-card-header>
            <mat-card-title>Negative Words</mat-card-title>
          </mat-card-header>
          <img mat-card-image width="100%" height="475px" src="../../assets/data-visualization/negative_words.png" alt="Negative Words">
          <mat-card-content>
            <p>
              Unfortunately, due to the imbalance of the classes, there are a lot of words that can be observed in the
              positive cloud as well.
              But if we look more closely at the cloud, we can also find negative words like annoying, politics,
              terrible, etc...
            </p>
          </mat-card-content>
        </mat-card>
      </mat-grid-tile>
    </mat-grid-list>

  </div>

</div>
